# üîÑ –ü–ª–∞–Ω –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è —Å—É—â–Ω–æ—Å—Ç–µ–π –ø—Ä–æ–µ–∫—Ç–∞

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 17 –Ω–æ—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é  
**–û—Ü–µ–Ω–∫–∞ —Ç—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç:** 4-6 —á–∞—Å–æ–≤  
**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π (—Ç—Ä–µ–±—É–µ—Ç—Å—è –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å)

---

## üìã –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–π

| ‚Ññ | –¢–µ–∫—É—â–µ–µ –∏–º—è | –ù–æ–≤–æ–µ –∏–º—è | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –û—Ü–µ–Ω–∫–∞ |
|---|-------------|-----------|-----------|-----------|--------|
| 1 | `Structure` | `ThoughtsBySection` | üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–π | –í—ã—Å–æ–∫–∞—è | 99/100 |
| 2 | `Item` | `ThoughtInStructure` | üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–π | –°—Ä–µ–¥–Ω—è—è | 98/100 |
| 3 | `ThoughtsPlan` | `SectionHints` | üü° –í–∞–∂–Ω—ã–π | –ù–∏–∑–∫–∞—è | 97/100 |
| 4 | `Outline` | `SermonOutline` | üü° –í–∞–∂–Ω—ã–π | –°—Ä–µ–¥–Ω—è—è | 96/100 |
| 5 | `OutlinePoint` | `SermonPoint` | üü¢ –ñ–µ–ª–∞—Ç–µ–ª—å–Ω—ã–π | –ù–∏–∑–∫–∞—è | 96/100 |
| 6 | `Plan` | `SermonDraft` | üü° –í–∞–∂–Ω—ã–π | –°—Ä–µ–¥–Ω—è—è | 99/100 |

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### **–§–∞–∑–∞ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (30 –º–∏–Ω—É—Ç)**
- [ ] –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –≤–µ—Ç–∫—É: `git checkout -b refactor/rename-entities`
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç: `npm test`
- [ ] –°–¥–µ–ª–∞—Ç—å –∫–æ–º–º–∏—Ç —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- [ ] –ü—Ä–æ—á–∏—Ç–∞—Ç—å –≤–µ—Å—å –ø–ª–∞–Ω –¥–æ –∫–æ–Ω—Ü–∞

### **–§–∞–∑–∞ 2: –ü—Ä–æ—Å—Ç—ã–µ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è (1 —á–∞—Å)**
–ù–∞—á–∏–Ω–∞–µ–º —Å —Å—É—â–Ω–æ—Å—Ç–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ä–µ–∂–µ:

- [ ] **–ó–∞–¥–∞—á–∞ 3:** `ThoughtsPlan` ‚Üí `SectionHints`
- [ ] **–ó–∞–¥–∞—á–∞ 5:** `OutlinePoint` ‚Üí `SermonPoint`

### **–§–∞–∑–∞ 3: –°—Ä–µ–¥–Ω–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (2 —á–∞—Å–∞)**
- [ ] **–ó–∞–¥–∞—á–∞ 2:** `Item` ‚Üí `ThoughtInStructure`
- [ ] **–ó–∞–¥–∞—á–∞ 6:** `Plan` ‚Üí `SermonDraft`

### **–§–∞–∑–∞ 4: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (2-3 —á–∞—Å–∞)**
–¢—Ä–µ–±—É—é—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

- [ ] **–ó–∞–¥–∞—á–∞ 4:** `Outline` ‚Üí `SermonOutline`
- [ ] **–ó–∞–¥–∞—á–∞ 1:** `Structure` ‚Üí `ThoughtsBySection`

### **–§–∞–∑–∞ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è (30 –º–∏–Ω—É—Ç)**
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏–Ω—Ç–µ—Ä
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å TypeScript –æ—à–∏–±–∫–∏
- [ ] –°–¥–µ–ª–∞—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –∫–æ–º–º–∏—Ç

---

## üìù –î–µ—Ç–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–µ

---

## –ó–∞–¥–∞—á–∞ 1: Structure ‚Üí ThoughtsBySection

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–π  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –í—ã—Å–æ–∫–∞—è  
**–í—Ä–µ–º—è:** 90-120 –º–∏–Ω—É—Ç  

### –ü–æ—á–µ–º—É —ç—Ç–æ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –≤–∞–∂–Ω–æ:
`Structure` - —Å–ª–∏—à–∫–æ–º –æ–±—â–µ–µ —Å–ª–æ–≤–æ. `ThoughtsBySection` —á–µ—Ç–∫–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç: "–º—ã—Å–ª–∏, –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ —Å–µ–∫—Ü–∏—è–º –ø—Ä–æ–ø–æ–≤–µ–¥–∏".

### –§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:

#### 1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
**–§–∞–π–ª:** `frontend/app/models/models.ts`

```typescript
// –ë–´–õ–û:
export interface Structure {
  introduction: string[];
  main: string[];
  conclusion: string[];
  ambiguous: string[];
}

// –°–¢–ê–õ–û:
export interface ThoughtsBySection {
  introduction: string[];
  main: string[];
  conclusion: string[];
  ambiguous: string[];
}
```

#### 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ Sermon
**–§–∞–π–ª:** `frontend/app/models/models.ts`

```typescript
// –ë–´–õ–û:
export interface Sermon {
  // ...
  structure?: Structure;
}

// –°–¢–ê–õ–û:
export interface Sermon {
  // ...
  thoughtsBySection?: ThoughtsBySection;
}
```

#### 3. API routes

**–§–∞–π–ª:** `frontend/app/api/structure/route.ts`
- –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Ñ–∞–π–ª: `structure/route.ts` ‚Üí `thoughts-by-section/route.ts`
- –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:

```typescript
// –ë–´–õ–û:
const { structure } = await request.json();
await sermonDocRef.update({ structure });

// –°–¢–ê–õ–û:
const { thoughtsBySection } = await request.json();
await sermonDocRef.update({ thoughtsBySection });
```

#### 4. Hooks

**–§–∞–π–ª:** `frontend/app/hooks/useSermonStructureData.ts`

```typescript
// –ë–´–õ–û:
const [structure, setStructure] = useState<Structure>({ 
  introduction: [], 
  main: [], 
  conclusion: [], 
  ambiguous: [] 
});

// –°–¢–ê–õ–û:
const [thoughtsBySection, setThoughtsBySection] = useState<ThoughtsBySection>({ 
  introduction: [], 
  main: [], 
  conclusion: [], 
  ambiguous: [] 
});
```

#### 5. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

–ü–æ–∏—Å–∫ –≤—Å–µ—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π:
```bash
grep -r "structure" frontend/app/components/ --include="*.tsx" --include="*.ts"
```

–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã:
- `frontend/app/components/Column.tsx`
- `frontend/app/components/SortableItem.tsx`
- `frontend/app/components/sermon/StructureStats.tsx`
- `frontend/app/(pages)/(private)/sermons/[id]/structure/page.tsx`

**–ü—Ä–∏–º–µ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Column.tsx:**

```typescript
// –ë–´–õ–û:
interface ColumnProps {
  // ...
  onUpdateStructure?: (structure: Structure) => void;
}

// –°–¢–ê–õ–û:
interface ColumnProps {
  // ...
  onUpdateThoughtsBySection?: (thoughtsBySection: ThoughtsBySection) => void;
}
```

#### 6. Services

**–§–∞–π–ª:** `frontend/app/services/sortAI.service.ts`

```typescript
// –ë–´–õ–û:
export async function sortThoughtsWithAI(
  thoughts: Thought[]
): Promise<Structure> {
  // ...
}

// –°–¢–ê–õ–û:
export async function sortThoughtsWithAI(
  thoughts: Thought[]
): Promise<ThoughtsBySection> {
  // ...
}
```

#### 7. –¢–µ—Å—Ç—ã

–ù–∞–π—Ç–∏ –≤—Å–µ —Ç–µ—Å—Ç—ã:
```bash
find frontend/__tests__ -name "*.test.ts*" -exec grep -l "Structure" {} \;
```

–û–±–Ω–æ–≤–∏—Ç—å:
- `frontend/__tests__/api/repositories/sermons-repository.test.ts`
- `frontend/app/hooks/useSermonStructureData.test.ts`
- –ò –¥—Ä—É–≥–∏–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –ß–µ–∫–ª–∏—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
- [ ] –û–±–Ω–æ–≤–∏—Ç—å interface –≤ `models.ts`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å Sermon interface
- [ ] –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å API route —Ñ–∞–π–ª
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ hooks
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ services
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å `npm test` - –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–π—Ç–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å TypeScript: `npx tsc --noEmit`
- [ ] –ö–æ–º–º–∏—Ç: `git commit -m "refactor: rename Structure to ThoughtsBySection"`

---

## –ó–∞–¥–∞—á–∞ 2: Item ‚Üí ThoughtInStructure

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–π  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è  
**–í—Ä–µ–º—è:** 45-60 –º–∏–Ω—É—Ç  

### –ü–æ—á–µ–º—É —ç—Ç–æ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –≤–∞–∂–Ω–æ:
`Item` - —Å–ª–∏—à–∫–æ–º –æ–±—â–µ–µ. `ThoughtInStructure` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç: –º—ã—Å–ª—å –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–ø–æ–≤–µ–¥–∏.

### –§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:

#### 1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
**–§–∞–π–ª:** `frontend/app/models/models.ts`

```typescript
// –ë–´–õ–û:
export interface Item {
  id: string;
  content: string;
  customTagNames?: TagInfo[];
  requiredTags?: string[];
  outlinePoint?: { text: string; section: string };
  outlinePointId?: string | null;
  position?: number;
}

// –°–¢–ê–õ–û:
export interface ThoughtInStructure {
  id: string;
  content: string;
  customTagNames?: TagInfo[];
  requiredTags?: string[];
  outlinePoint?: { text: string; section: string };
  outlinePointId?: string | null;
  position?: number;
}
```

#### 2. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

**–§–∞–π–ª:** `frontend/app/components/Column.tsx`

```typescript
// –ë–´–õ–û:
interface ColumnProps {
  items: Item[];
  onEdit: (item: Item) => void;
}

// –°–¢–ê–õ–û:
interface ColumnProps {
  items: ThoughtInStructure[];
  onEdit: (item: ThoughtInStructure) => void;
}
```

**–§–∞–π–ª:** `frontend/app/components/SortableItem.tsx`

```typescript
// –ë–´–õ–û:
interface SortableItemProps {
  item: Item;
}

// –°–¢–ê–õ–û:
interface SortableItemProps {
  item: ThoughtInStructure;
}
```

#### 3. –•—É–∫–∏ –∏ —É—Ç–∏–ª–∏—Ç—ã

**–§–∞–π–ª:** `frontend/app/hooks/useSermonStructureData.ts`

–ù–∞–π—Ç–∏ –≤—Å–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `Item` –∏ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ `ThoughtInStructure`.

#### 4. –¢–µ—Å—Ç—ã

```bash
grep -r "Item" frontend/__tests__/ --include="*.test.ts*"
```

### –ß–µ–∫–ª–∏—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
- [ ] –û–±–Ω–æ–≤–∏—Ç—å interface –≤ `models.ts`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å Column.tsx
- [ ] –û–±–Ω–æ–≤–∏—Ç—å SortableItem.tsx
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ hooks
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç—ã
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å `npm test`
- [ ] –ö–æ–º–º–∏—Ç: `git commit -m "refactor: rename Item to ThoughtInStructure"`

---

## –ó–∞–¥–∞—á–∞ 3: ThoughtsPlan ‚Üí SectionHints

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–∞–∂–Ω—ã–π  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –ù–∏–∑–∫–∞—è  
**–í—Ä–µ–º—è:** 20-30 –º–∏–Ω—É—Ç  

### –ü–æ—á–µ–º—É —ç—Ç–æ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –≤–∞–∂–Ω–æ:
`ThoughtsPlan` –Ω–µ—è—Å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ. `SectionHints` —á–µ—Ç–∫–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç: –ø–æ–¥—Å–∫–∞–∑–∫–∏ AI –¥–ª—è –∫–∞–∂–¥–æ–π —Å–µ–∫—Ü–∏–∏.

### –§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:

#### 1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
**–§–∞–π–ª:** `frontend/app/models/models.ts`

```typescript
// –ë–´–õ–û:
export interface ThoughtsPlan {
  introduction: string;
  main: string;
  conclusion: string;
}

// –°–¢–ê–õ–û:
export interface SectionHints {
  introduction: string;
  main: string;
  conclusion: string;
}
```

#### 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ Insights
**–§–∞–π–ª:** `frontend/app/models/models.ts`

```typescript
// –ë–´–õ–û:
export interface Insights {
  topics: string[];
  relatedVerses: VerseWithRelevance[];
  possibleDirections: DirectionSuggestion[];
  thoughtsPlan?: ThoughtsPlan;
}

// –°–¢–ê–õ–û:
export interface Insights {
  topics: string[];
  relatedVerses: VerseWithRelevance[];
  possibleDirections: DirectionSuggestion[];
  sectionHints?: SectionHints;
}
```

#### 3. API routes

**–§–∞–π–ª:** `frontend/app/api/insights/plan/route.ts`

```typescript
// –ë–´–õ–û:
const thoughtsPlan = await generateThoughtsPlan(/* ... */);
return NextResponse.json({ thoughtsPlan });

// –°–¢–ê–õ–û:
const sectionHints = await generateSectionHints(/* ... */);
return NextResponse.json({ sectionHints });
```

#### 4. OpenAI client

**–§–∞–π–ª:** `frontend/app/api/clients/openAI.client.ts`

–ù–∞–π—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å:
```typescript
// –ë–´–õ–û:
export async function generateThoughtsPlan(/* ... */): Promise<ThoughtsPlan>

// –°–¢–ê–õ–û:
export async function generateSectionHints(/* ... */): Promise<SectionHints>
```

#### 5. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

**–§–∞–π–ª:** `frontend/app/components/sermon/KnowledgeSection.tsx`

```typescript
// –ë–´–õ–û:
const [thoughtsPlan, setThoughtsPlan] = useState<ThoughtsPlan | null>(null);

// –°–¢–ê–õ–û:
const [sectionHints, setSectionHints] = useState<SectionHints | null>(null);
```

### –ß–µ–∫–ª–∏—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
- [ ] –û–±–Ω–æ–≤–∏—Ç—å interface –≤ `models.ts`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å Insights interface
- [ ] –û–±–Ω–æ–≤–∏—Ç—å API routes
- [ ] –û–±–Ω–æ–≤–∏—Ç—å OpenAI client
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç—ã
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å `npm test`
- [ ] –ö–æ–º–º–∏—Ç: `git commit -m "refactor: rename ThoughtsPlan to SectionHints"`

---

## –ó–∞–¥–∞—á–∞ 4: Outline ‚Üí SermonOutline

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–∞–∂–Ω—ã–π  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è  
**–í—Ä–µ–º—è:** 45-60 –º–∏–Ω—É—Ç  

### –ü–æ—á–µ–º—É —ç—Ç–æ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –≤–∞–∂–Ω–æ:
–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ—Ñ–∏–∫—Å–∞ `Sermon` –¥–ª—è —è—Å–Ω–æ—Å—Ç–∏ –∏ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ —Å –¥—Ä—É–≥–∏–º–∏ —Å—É—â–Ω–æ—Å—Ç—è–º–∏.

### –§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:

#### 1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
**–§–∞–π–ª:** `frontend/app/models/models.ts`

```typescript
// –ë–´–õ–û:
export interface Outline {
  introduction: OutlinePoint[];
  main: OutlinePoint[];
  conclusion: OutlinePoint[];
}

// –°–¢–ê–õ–û:
export interface SermonOutline {
  introduction: SermonPoint[];
  main: SermonPoint[];
  conclusion: SermonPoint[];
}
```

**–í–ù–ò–ú–ê–ù–ò–ï:** –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ–º `OutlinePoint` ‚Üí `SermonPoint`

#### 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ Sermon
**–§–∞–π–ª:** `frontend/app/models/models.ts`

```typescript
// –ë–´–õ–û:
export interface Sermon {
  // ...
  outline?: Outline;
}

// –°–¢–ê–õ–û:
export interface Sermon {
  // ...
  outline?: SermonOutline;
}
```

#### 3. API routes

**–§–∞–π–ª:** `frontend/app/api/sermons/outline/route.ts`

```typescript
// –ë–´–õ–û:
const outline: Outline = await getOutline(sermonId);

// –°–¢–ê–õ–û:
const outline: SermonOutline = await getSermonOutline(sermonId);
```

#### 4. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

**–§–∞–π–ª:** `frontend/app/components/sermon/SermonOutline.tsx`

```typescript
// –ë–´–õ–û:
interface SermonOutlineProps {
  outline: Outline;
}

// –°–¢–ê–õ–û:
interface SermonOutlineProps {
  outline: SermonOutline;
}
```

**–§–∞–π–ª:** `frontend/app/components/plan/OutlinePointCard.tsx`

–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Ñ–∞–π–ª: `OutlinePointCard.tsx` ‚Üí `SermonPointCard.tsx`

```typescript
// –ë–´–õ–û:
interface OutlinePointCardProps {
  point: OutlinePoint;
}

// –°–¢–ê–õ–û:
interface SermonPointCardProps {
  point: SermonPoint;
}
```

#### 5. Hooks

**–§–∞–π–ª:** `frontend/app/hooks/usePlan.ts`

```typescript
// –ë–´–õ–û:
const [outline, setOutline] = useState<Outline | null>(null);

// –°–¢–ê–õ–û:
const [outline, setOutline] = useState<SermonOutline | null>(null);
```

### –ß–µ–∫–ª–∏—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
- [ ] –û–±–Ω–æ–≤–∏—Ç—å interface –≤ `models.ts`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å Sermon interface
- [ ] –û–±–Ω–æ–≤–∏—Ç—å API routes
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- [ ] –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Ñ–∞–π–ª OutlinePointCard
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ hooks
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç—ã
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å `npm test`
- [ ] –ö–æ–º–º–∏—Ç: `git commit -m "refactor: rename Outline to SermonOutline and OutlinePoint to SermonPoint"`

---

## –ó–∞–¥–∞—á–∞ 5: OutlinePoint ‚Üí SermonPoint

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ñ–µ–ª–∞—Ç–µ–ª—å–Ω—ã–π  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –ù–∏–∑–∫–∞—è  
**–í—Ä–µ–º—è:** 20-30 –º–∏–Ω—É—Ç  

### –ü–æ—á–µ–º—É —ç—Ç–æ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –≤–∞–∂–Ω–æ:
–°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –∏ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Å `SermonOutline`.

**–í–ù–ò–ú–ê–ù–ò–ï:** –≠—Ç–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å –ó–∞–¥–∞—á–µ–π 4!

### –§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:

#### 1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
**–§–∞–π–ª:** `frontend/app/models/models.ts`

```typescript
// –ë–´–õ–û:
export interface OutlinePoint {
  id: string;
  text: string;
  isReviewed?: boolean;
}

// –°–¢–ê–õ–û:
export interface SermonPoint {
  id: string;
  text: string;
  isReviewed?: boolean;
}
```

#### 2. –í—Å–µ —Ñ–∞–π–ª—ã, –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

–ü–æ–∏—Å–∫:
```bash
grep -r "OutlinePoint" frontend/ --include="*.tsx" --include="*.ts"
```

–ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ –≤—Ö–æ–∂–¥–µ–Ω–∏—è –Ω–∞ `SermonPoint`.

### –ß–µ–∫–ª–∏—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
- [ ] –û–±–Ω–æ–≤–∏—Ç—å interface –≤ `models.ts`
- [ ] –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–¥–µ
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç—ã
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å `npm test`
- [ ] (–ö–æ–º–º–∏—Ç –¥–µ–ª–∞–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å –ó–∞–¥–∞—á–µ–π 4)

---

## –ó–∞–¥–∞—á–∞ 6: Plan ‚Üí SermonDraft

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–∞–∂–Ω—ã–π  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è  
**–í—Ä–µ–º—è:** 45-60 –º–∏–Ω—É—Ç  

### –ü–æ—á–µ–º—É —ç—Ç–æ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –≤–∞–∂–Ω–æ:
`Plan` —Å–ª–∏—à–∫–æ–º –æ–±—â–µ–µ. `SermonDraft` —á–µ—Ç–∫–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç: —ç—Ç–æ —á–µ—Ä–Ω–æ–≤–∏–∫ —Ç–µ–∫—Å—Ç–∞ –ø—Ä–æ–ø–æ–≤–µ–¥–∏.

### –§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:

#### 1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
**–§–∞–π–ª:** `frontend/app/models/models.ts`

```typescript
// –ë–´–õ–û:
export interface Plan {
  introduction: {
    outline: string;
    outlinePoints?: Record<string, string>;
  }
  main: {
    outline: string;
    outlinePoints?: Record<string, string>;
  }
  conclusion: {
    outline: string;
    outlinePoints?: Record<string, string>;
  }
}

// –°–¢–ê–õ–û:
export interface SermonDraft {
  introduction: {
    outline: string;
    outlinePoints?: Record<string, string>;
  }
  main: {
    outline: string;
    outlinePoints?: Record<string, string>;
  }
  conclusion: {
    outline: string;
    outlinePoints?: Record<string, string>;
  }
}
```

#### 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ Sermon
**–§–∞–π–ª:** `frontend/app/models/models.ts`

```typescript
// –ë–´–õ–û:
export interface Sermon {
  // ...
  plan?: Plan;
}

// –°–¢–ê–õ–û:
export interface Sermon {
  // ...
  draft?: SermonDraft;
}
```

#### 3. API routes

**–§–∞–π–ª:** `frontend/app/api/sermons/[id]/plan/route.ts`

–ú–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Ç—å `/plan` –≤ URL (–Ω–µ –ª–æ–º–∞—Ç—å API), –Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —Ç–∏–ø—ã:

```typescript
// –ë–´–õ–û:
async function generateFullPlan(sermonId: string): Promise<Plan> {
  // ...
}

// –°–¢–ê–õ–û:
async function generateFullSermonDraft(sermonId: string): Promise<SermonDraft> {
  // ...
}
```

#### 4. Hooks

**–§–∞–π–ª:** `frontend/app/hooks/usePlan.ts`

```typescript
// –ë–´–õ–û:
const [plan, setPlan] = useState<Plan | null>(null);

// –°–¢–ê–õ–û:
const [draft, setDraft] = useState<SermonDraft | null>(null);
```

#### 5. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

**–§–∞–π–ª:** `frontend/app/components/plan/PlanSection.tsx`

```typescript
// –ë–´–õ–û:
interface PlanSectionProps {
  plan: Plan;
}

// –°–¢–ê–õ–û:
interface PlanSectionProps {
  draft: SermonDraft;
}
```

**–§–∞–π–ª:** `frontend/app/(pages)/(private)/sermons/[id]/plan/page.tsx`

```typescript
// –ë–´–õ–û:
const { plan, loading, error } = usePlan(sermonId);

// –°–¢–ê–õ–û:
const { draft, loading, error } = usePlan(sermonId);
```

### –ß–µ–∫–ª–∏—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
- [ ] –û–±–Ω–æ–≤–∏—Ç—å interface –≤ `models.ts`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å Sermon interface
- [ ] –û–±–Ω–æ–≤–∏—Ç—å API routes (—Ç–∏–ø—ã, –Ω–µ URL)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ hooks
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç—ã
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å `npm test`
- [ ] –ö–æ–º–º–∏—Ç: `git commit -m "refactor: rename Plan to SermonDraft"`

---

## üîç –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –ø–æ–∏—Å–∫–∞

### –ù–∞–π—Ç–∏ –≤—Å–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:
```bash
# –î–ª—è Structure:
grep -r "Structure" frontend/ --include="*.tsx" --include="*.ts" | grep -v "node_modules"

# –î–ª—è Item:
grep -r ": Item" frontend/ --include="*.tsx" --include="*.ts"

# –î–ª—è Outline:
grep -r "Outline" frontend/ --include="*.tsx" --include="*.ts" | grep -v "node_modules"
```

### –ù–∞–π—Ç–∏ –∏–º–ø–æ—Ä—Ç—ã:
```bash
grep -r "import.*Structure" frontend/ --include="*.tsx" --include="*.ts"
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å TypeScript –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π:
```bash
cd frontend
npx tsc --noEmit
```

### –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã:
```bash
cd frontend
npm test
```

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (Firestore)
–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –ø–æ–ª–µ–π –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ Sermon, –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç:
- **–õ–∏–±–æ**: –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ Firestore (–º–∏–≥—Ä–∞—Ü–∏—è)
- **–õ–∏–±–æ**: –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏

**–ü—Ä–∏–º–µ—Ä –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏:**
```typescript
const sermon = docSnap.data() as Sermon;

// –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç–∞—Ä–æ–≥–æ –ø–æ–ª—è
if (!sermon.thoughtsBySection && sermon.structure) {
  sermon.thoughtsBySection = sermon.structure;
}
```

### 2. API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
–ï—Å–ª–∏ API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏–∑–≤–Ω–µ (–º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –¥—Ä—É–≥–∏–µ —Å–µ—Ä–≤–∏—Å—ã), –Ω–µ –º–µ–Ω—è–π—Ç–µ URL:
- –û—Å—Ç–∞–≤—å—Ç–µ `/api/structure` ‚Üí –Ω–æ –≤–Ω—É—Ç—Ä–∏ —Ä–∞–±–æ—Ç–∞–π—Ç–µ —Å `ThoughtsBySection`
- –°–¥–µ–ª–∞–π—Ç–µ –∞–ª–∏–∞—Å—ã –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

### 3. Git –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã
–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ –≤ –∫–æ–º–∞–Ω–¥–µ:
- –ü—Ä–µ–¥—É–ø—Ä–µ–¥–∏—Ç–µ –∫–æ–ª–ª–µ–≥ –æ –±–æ–ª—å—à–æ–º —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ
- –î–µ–ª–∞–π—Ç–µ —ç—Ç–æ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –≤–µ—Ç–∫–µ
- –ú–µ—Ä–∂–∏—Ç–µ –≤ –ø–µ—Ä–∏–æ–¥ –Ω–∏–∑–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

---

## ‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç

### –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º:
- [ ] –ü—Ä–æ—á–∏—Ç–∞–ª –≤–µ—Å—å –¥–æ–∫—É–º–µ–Ω—Ç
- [ ] –°–æ–∑–¥–∞–ª –≤–µ—Ç–∫—É `refactor/rename-entities`
- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] –°–¥–µ–ª–∞–ª backup –∏–ª–∏ –∫–æ–º–º–∏—Ç

### –í–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
- [ ] –í—ã–ø–æ–ª–Ω—è—é –∑–∞–¥–∞—á–∏ –ø–æ –ø–æ—Ä—è–¥–∫—É
- [ ] –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏ - –∑–∞–ø—É—Å–∫–∞—é —Ç–µ—Å—Ç—ã
- [ ] –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏ - –¥–µ–ª–∞—é –∫–æ–º–º–∏—Ç
- [ ] –ü—Ä–æ–≤–µ—Ä—è—é TypeScript –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:
- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç: `npm test`
- [ ] –ù–µ—Ç TypeScript –æ—à–∏–±–æ–∫: `npx tsc --noEmit`
- [ ] –ù–µ—Ç lint –æ—à–∏–±–æ–∫: `npm run lint`
- [ ] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- [ ] –°–æ–∑–¥–∞–ª Pull Request —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π
- [ ] –ó–∞–ø—Ä–æ—Å–∏–ª code review

---

## üìä –¢—Ä–µ–∫–∏–Ω–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

–û—Ç–º–µ—á–∞–π—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏:

```
–ü—Ä–æ–≥—Ä–µ—Å—Å: [==........] 20% (1 –∏–∑ 6)

‚úÖ –ó–∞–¥–∞—á–∞ 3: ThoughtsPlan ‚Üí SectionHints
‚¨ú –ó–∞–¥–∞—á–∞ 5: OutlinePoint ‚Üí SermonPoint  
‚¨ú –ó–∞–¥–∞—á–∞ 2: Item ‚Üí ThoughtInStructure
‚¨ú –ó–∞–¥–∞—á–∞ 6: Plan ‚Üí SermonDraft
‚¨ú –ó–∞–¥–∞—á–∞ 4: Outline ‚Üí SermonOutline
‚¨ú –ó–∞–¥–∞—á–∞ 1: Structure ‚Üí ThoughtsBySection
```

---

## üéì –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

### –°—Ç–∞—Ç—å–∏ –æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ:
- Martin Fowler - Refactoring: Improving the Design of Existing Code
- Michael Feathers - Working Effectively with Legacy Code

### TypeScript –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- https://www.typescriptlang.org/docs/handbook/2/everyday-types.html

---

**–£–¥–∞—á–∏ –≤ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ! üöÄ**

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º - –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Å—è –∏ –¥—É–º–∞–π, –Ω–µ —Å–ø–µ—à–∏.
–õ—É—á—à–µ –ø–æ—Ç—Ä–∞—Ç–∏—Ç—å –ª–∏—à–Ω–∏–µ 10 –º–∏–Ω—É—Ç –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É, —á–µ–º —á–∞—Å –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫.

